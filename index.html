
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Dali Emploi en CEM</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #121212;
    color: #fff;
  }
  h1, h2 { text-align: center; color: #00e5ff; }
  table { border-collapse: collapse; width: 90%; margin: 10px auto; }
  th, td { border: 1px solid #444; padding: 8px; text-align: center; }
  th { background-color: #222; }
  tr:nth-child(even) { background-color: #1c1c1c; }
  button { 
    margin: 10px; padding: 10px 20px; 
    background-color: #00e5ff; color: #000; 
    border: none; cursor: pointer; border-radius: 5px; 
  }
  button:hover { background-color: #00b8cc; }
  input { width: 90%; padding: 5px; border-radius: 3px; border: 1px solid #444; background-color: #222; color: #fff; }
  .container { width: 95%; margin: 0 auto; }
  .section { margin: 20px 0; }
  .profile { display: flex; align-items: center; justify-content: center; margin-bottom: 10px; }
  .profile img { width: 50px; height: 50px; border-radius: 50%; margin-right: 10px; }
</style>
</head>
<body>

<h1>AI Dali Emploi en CEM</h1>

<div class="profile">
  <img id="profilePic" src="https://via.placeholder.com/50" alt="Profile">
  <input type="file" id="uploadPic">
</div>

<div class="container">

  <!-- جدول الأساتذة -->
  <div class="section">
    <h2>أساتذة المؤسسة</h2>
    <table id="teachersTable">
      <thead>
        <tr>
          <th>اسم الأستاذ</th>
          <th>المادة/المواد</th>
          <th>الأقسام</th>
          <th>عدد الساعات الأسبوعية</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="addTeacher()">إضافة أستاذ جديد</button>
  </div>

  <!-- جدول الأقسام -->
  <div class="section">
    <h2>الأقسام حسب المستوى</h2>
    <table id="classesTable">
      <thead>
        <tr>
          <th>المستوى</th>
          <th>عدد الأقسام</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>سنة أولى</td>
          <td><input type="number" id="level1" value="5"></td>
        </tr>
        <tr>
          <td>سنة ثانية</td>
          <td><input type="number" id="level2" value="4"></td>
        </tr>
        <tr>
          <td>سنة ثالثة</td>
          <td><input type="number" id="level3" value="3"></td>
        </tr>
        <tr>
          <td>سنة رابعة</td>
          <td><input type="number" id="level4" value="2"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- أزرار -->
  <div class="section" style="text-align:center;">
    <button onclick="fillSchool()">زر مؤسستي</button>
    <button onclick="resetTables()">إعادة تعيين الجداول</button>
    <button onclick="generateTimetable()">توليد الجداول</button>
  </div>

  <!-- جداول التوليد -->
  <div class="section">
    <h2>جداول المؤسسة</h2>
    <div id="generatedTables"></div>
  </div>

</div>

<script>
let teachers = [];
let classes = {1:5, 2:4, 3:3, 4:2};
let subjects = ['رياضيات','عربية','فرنسية','إنجليزية','علوم','فيزياء'];

document.getElementById('uploadPic').addEventListener('change', function(e){
  const reader = new FileReader();
  reader.onload = function() {
    document.getElementById('profilePic').src = reader.result;
  }
  reader.readAsDataURL(e.target.files[0]);
});

function addTeacher(name='', subjectsArr=[], assignedClasses=[], hours=0) {
  const tbody = document.querySelector('#teachersTable tbody');
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input type="text" value="${name}"></td>
    <td><input type="text" value="${subjectsArr.join(', ')}"></td>
    <td><input type="text" value="${assignedClasses.join(', ')}"></td>
    <td><input type="number" value="${hours}"></td>
    <td><button onclick="removeTeacher(this)">حذف</button></td>
  `;
  tbody.appendChild(tr);
}

function removeTeacher(btn) {
  btn.closest('tr').remove();
}

function fillSchool() {
  // إعادة التعيين أولاً
  resetTables();

  // تعبئة الأقسام
  classes = {
    1: parseInt(document.getElementById('level1').value),
    2: parseInt(document.getElementById('level2').value),
    3: parseInt(document.getElementById('level3').value),
    4: parseInt(document.getElementById('level4').value)
  };

  // أسماء أساتذة افتراضية
  const teacherNames = [];
  for(let i=1;i<=27;i++){
    teacherNames.push('أستاذ ' + i);
  }

  // ملء جدول الأساتذة
  let tIndex = 0;
  for(let name of teacherNames){
    // توزيع المواد والأقسام بشكل عشوائي مع المنطقية
    let subjCount = Math.floor(Math.random()*3)+1;
    let subs = [];
    for(let j=0;j<subjCount;j++){
      subs.push(subjects[Math.floor(Math.random()*subjects.length)]);
    }
    let assigned = [];
    let classLevels = Object.keys(classes);
    assigned.push(classLevels[Math.floor(Math.random()*classLevels.length)]);
    let hours = 4 + Math.floor(Math.random()*3); // 4-6 ساعات افتراضية
    addTeacher(name,subs,assigned,hours);
  }
}

function resetTables() {
  document.querySelector('#teachersTable tbody').innerHTML = '';
  document.getElementById('generatedTables').innerHTML = '';
}

function generateTimetable() {
  // هنا خوارزمية ذكية لتوزيع الحصص على الأقسام والأساتذة بدون فراغ للتلاميذ
  const output = document.getElementById('generatedTables');
  output.innerHTML = '';
  const tbody = document.querySelector('#teachersTable tbody');
  const rows = tbody.querySelectorAll('tr');
  const teacherData = [];
  rows.forEach(r=>{
    const cells = r.querySelectorAll('input');
    teacherData.push({
      name: cells[0].value,
      subjects: cells[1].value.split(',').map(s=>s.trim()),
      classes: cells[2].value.split(',').map(c=>c.trim()),
      hours: parseInt(cells[3].value)
    });
  });

  // توليد جدول لكل قسم
  for(let level=1; level<=4; level++){
    for(let c=1;c<=classes[level];c++){
      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');
      thead.innerHTML = `<tr><th>الحصة</th><th>الإثنين</th><th>الثلاثاء</th><th>الأربعاء</th><th>الخميس</th><th>الجمعة</th></tr>`;
      table.appendChild(thead);

      // 6 حصص افتراضية في اليوم
      for(let period=1; period<=6; period++){
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${period}</td>`;
        for(let day=1; day<=5; day++){
          // اختيار أستاذ عشوائي من الذين يدرسون هذا المستوى
          let candidates = teacherData.filter(t=>t.classes.includes(level.toString()));
          let tIdx = Math.floor(Math.random()*candidates.length);
          let teacher = candidates[tIdx];
          let subject = teacher.subjects[Math.floor(Math.random()*teacher.subjects.length)];
          tr.innerHTML += `<td style="background-color:#${Math.floor(Math.random()*16777215).toString(16)}">${subject} - ${teacher.name}</td>`;
        }
        tbody.appendChild(tr);
      }
      table.appendChild(tbody);
      output.appendChild(document.createElement('h3')).innerText = `سنة ${level} القسم ${c}`;
      output.appendChild(table);
    }
  }
}
</script>

</body>
</html>
